@echo off
REM ???????????????????????????????????????????????????????????????????????????
REM  GITHUB BACKUP & DEPLOY - WINDOWS BATCH SCRIPT
REM ???????????????????????????????????????????????????????????????????????????

echo.
echo ???????????????????????????????????????????????????????????????????????????
echo ?                                                                         ?
echo ?                  GITHUB BACKUP & DEPLOY SCRIPT                         ?
echo ?                                                                         ?
echo ?              Your FinTech Portfolio to GitHub Pages                    ?
echo ?                                                                         ?
echo ???????????????????????????????????????????????????????????????????????????
echo.

REM Check if Git is installed
git --version >nul 2>&1
if errorlevel 1 (
    echo ? ERROR: Git is not installed or not in PATH
    echo.
    echo Please download and install Git from: https://git-scm.com/download/win
    echo.
    pause
    exit /b 1
)

echo ? Git is installed
echo.

REM Navigate to portfolio folder
cd /d C:\Users\aayus\portfolio-website

if errorlevel 1 (
    echo ? ERROR: Cannot find portfolio folder
    echo Expected: C:\Users\aayus\portfolio-website
    pause
    exit /b 1
)

echo ? Portfolio folder found
echo.

REM Check if already a git repository
if exist .git (
    echo ??  This folder is already a Git repository
    echo.
    choice /C YN /M "Do you want to push existing repository? (Y/N)"
    if errorlevel 2 goto :skip_init
    if errorlevel 1 goto :push_existing
)

REM Initialize Git
:init_git
echo Initializing Git repository...
git init
if errorlevel 1 (
    echo ? ERROR: Failed to initialize Git
    pause
    exit /b 1
)
echo ? Git initialized
echo.

REM Configure Git (first time)
echo Configuring Git...
git config user.name "Portfolio Developer"
git config user.email "portfolio@example.com"
echo ? Git configured
echo.

REM Add all files
echo Adding all files...
git add .
if errorlevel 1 (
    echo ? ERROR: Failed to add files
    pause
    exit /b 1
)
echo ? Files added
echo.

REM Create initial commit
echo Creating initial commit...
git commit -m "Initial portfolio upload - all files"
if errorlevel 1 (
    echo ??  Note: Files may already be committed
)
echo ? Commit created
echo.

REM Create main branch
echo Creating main branch...
git branch -M main
echo ? Branch created
echo.

goto :get_username

:push_existing
echo.
echo Pushing existing repository...
goto :get_username

:get_username
echo.
echo ???????????????????????????????????????????????????????????????????????????
echo GITHUB SETUP REQUIRED
echo ???????????????????????????????????????????????????????????????????????????
echo.
echo Before continuing, you need:
echo  1. GitHub account (create at https://github.com)
echo  2. Repository created (at https://github.com/new)
echo  3. Personal Access Token (at https://github.com/settings/tokens/new)
echo.
set /p username="Enter your GitHub username: "

if "%username%"=="" (
    echo ? Username is required
    pause
    exit /b 1
)

set /p reponame="Enter repository name (default: portfolio): "
if "%reponame%"=="" set reponame=portfolio

echo.
echo Adding remote repository...
echo Repository URL: https://github.com/%username%/%reponame%.git
echo.

git remote remove origin 2>nul
git remote add origin https://github.com/%username%/%reponame%.git

if errorlevel 1 (
    echo ? ERROR: Failed to add remote repository
    pause
    exit /b 1
)

echo ? Remote repository added
echo.

REM Push to GitHub
echo ???????????????????????????????????????????????????????????????????????????
echo PUSHING TO GITHUB
echo ???????????????????????????????????????????????????????????????????????????
echo.
echo When prompted for authentication:
echo  Username: %username%
echo  Password: Paste your Personal Access Token (NOT your GitHub password!)
echo.
echo Get token at: https://github.com/settings/tokens/new
echo.
pause

echo Pushing to GitHub...
git push -u origin main

if errorlevel 1 (
    echo.
    echo ? ERROR: Failed to push to GitHub
    echo.
    echo Troubleshooting:
    echo  1. Check your username is correct
    echo  2. Check repository exists
    echo  3. Use Personal Access Token (not password)
    echo  4. Token must have 'repo' scope
    echo.
    pause
    exit /b 1
)

echo.
echo ???????????????????????????????????????????????????????????????????????????
echo ? FILES PUSHED TO GITHUB SUCCESSFULLY!
echo ???????????????????????????????????????????????????????????????????????????
echo.
echo Your repository:
echo   https://github.com/%username%/%reponame%
echo.

REM Enable GitHub Pages
:enable_pages
echo.
choice /C YN /M "Do you want to enable GitHub Pages? (Y/N)"
if errorlevel 2 goto :skip_pages
if errorlevel 1 (
    echo.
    echo To enable GitHub Pages:
    echo  1. Go to: https://github.com/%username%/%reponame%/settings/pages
    echo  2. Source branch: main
    echo  3. Folder: / (root)
    echo  4. Click Save
    echo.
    echo Your portfolio will be live at:
    echo   https://%username%.github.io/%reponame%
    echo.
    echo Wait 1-2 minutes for deployment...
)

:skip_pages
echo.
echo ???????????????????????????????????????????????????????????????????????????
echo ?? SETUP COMPLETE!
echo ???????????????????????????????????????????????????????????????????????????
echo.
echo Your portfolio is now:
echo  ? Backed up on GitHub
echo  ? Under version control
echo  ? Ready for deployment
echo.
echo Next steps:
echo  1. Enable GitHub Pages (if not done)
echo  2. Visit your live site
echo  3. Open admin.html and add your content
echo  4. Commit and push updates
echo.
echo Happy coding!
echo.
pause
goto :end

:skip_init
echo Skipping initialization...
goto :get_username

:end
REM Keep window open to see output
pause
